{% extends 'base.html' %}

{% block breadcrumbs %}
{% if perms.articles.change_post %}
<p><a href="{% url 'edit_page' post.slug %}">üñäÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a></p>
{% endif %}

{% if user.is_authenticated %}
    {% if post in user.favorite_posts.all %}
        <a href="{% url 'remove_favorite' post.id %}">- –£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ</a>
    {% else %}
        <a href="{% url 'add_favorite' post.id %}">+ –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</a>
    {% endif %}
{% endif %}

<!-- –¢–µ–≥–∏ -->
{% with post.tags.all as tags %}
{% if tags %}
<p>
    <ul class="post-tags-list">
        <li>–¢–µ–≥–∏:</li>
        {% for t in tags %}
        <li><a href="{{t.get_absolute_url}}">{{t.tag}}</a></li>
        {% endfor %}
    </ul>
</p>
{% endif %}
{% endwith %}
{% endblock %}

{% block content %}
<div class="post-and-comments">
    <div class="post-section">
        <h1>{{post.title}}</h1>

        {% if post.photo %}
            <p><img class="img-article-left" src="{{post.photo.url}}"></p>
        {% endif %}
        <p style="color: #FED305; font-family: 'RobotoMono-Light'; font-size: 14px;">–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: {{ post.read_num }}</p>
        <div class="post-content">{{post.content|linebreaks}}</div>
    </div>

    <div class="comment-section">
        <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</h3>
        <!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->

        <form method="post" action="">
            {% csrf_token %}
            <table class="new-comment">
                {% for f in comment_form %}
                    <tr>
                        <td>{{ f.label }}</td>
                        <td>{{ f }}</td>
                        <td><button type="submit">-></button></td>
                    </tr>
                {% endfor %}
            </table>
        </form>

        <!-- –í—ã–≤–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
        {% if post.comments.all %}
          <table>
            {% for comment in post.comments.all %}
              <tr>
                  <td class="comment-date">{{comment.created|date:"d.m.Y H:i"}}</td>
                  <td class="commenter-name">{{ comment.commenter.username }}:</td>
                  <td class="comment-body">{{ comment.body }}</td>
                  <td class="comment-rm">
                      {% if user.is_authenticated %}
                        {% if comment.commenter.id == user.id or user.is_staff %}
                            <a href="{% url 'remove_comment' comment.id %}">üóëÔ∏è</a>
                        {% endif %}
                      {% endif %}
                  </td>
              </tr>
            {% endfor %}
          </table>
        {% endif %}
    </div>
</div>
{% endblock %}
